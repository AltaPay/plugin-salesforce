"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[348],{23254(e,t,n){n.d(t,{N0:()=>l,OE:()=>r,i2:()=>c,v1:()=>i});var a=n(35490);const r=(e="",t={gaps:[],lengths:[]})=>{let n=e.replace(/[^0-9]/g,""),a=n.length;a===t.lengths[0]+1&&(n=n.substr(0,t.lengths[0]),a=n.length);let r=n.split("");return t.gaps.forEach((e,t)=>{a>e&&r.splice(e+t,0," ")}),r.join("")},l=e=>{if(e)return{visa:a.nL,mastercard:a.uI,"master card":a.uI,"american express":a.Nx,"american-express":a.Nx,amex:a.Nx,discover:a.BP}[e.toLowerCase()]},c=e=>{if(e)return{visa:"Visa",mastercard:"Master Card","american-express":"Amex",discover:"Discover"}[e]},i=e=>{const t=e.replace(/\s/g,"");return t.slice(0,-4).replace(/\d/g,"*")+t.slice(-4)}},73437(e,t,n){n.d(t,{A:()=>o});var a=n(77810),r=n(75826),l=n.n(r),c=n(27821),i=n(62539);const s=({address:e})=>a.createElement(i.az,null,a.createElement(c.E,null,e.firstName," ",e.lastName),a.createElement(c.E,null,e.address1),a.createElement(c.E,null,e.city,", ",e.stateCode," ",e.postalCode),a.createElement(c.E,null,e.countryCode));s.propTypes={address:l().object};const o=s},95657(e,t,n){n.r(t),n.d(t,{default:()=>ie});var a=n(18801),r=n(28407),l=n(10939),c=n(77810),i=n(41863),s=n(16602),o=n(62539),m=n(79237),u=n(92519),d=n(91311),p=n(27821),E=n(17415),f=n(95266),y=n(85771),g=n(51279),h=n(59247),v=n(11692),b=n(17778),A=n(49785),_=n(64965),k=n(27869),S=n(90031),w=n(23254),I=n(4026),j=n(2702),x=n(18222),O=n(87916),M=n(73437),B=n(64180),D=n(75826),z=n.n(D),P=n(38932),C=n(93613),N=n(63560);const T=({form:e,prefix:t=""})=>{const n=(0,P.A)({form:e,prefix:t}),a=e.watch(`${t}password`);return c.createElement(o.az,null,c.createElement(u.B,{spacing:5},c.createElement(N.A,n.email),c.createElement(u.B,{spacing:3,paddingBottom:2},c.createElement(N.A,n.password),c.createElement(C.A,{value:a}))),c.createElement(N.A,(0,B.A)({},n.firstName,{type:"hidden"})),c.createElement(N.A,(0,B.A)({},n.lastName,{type:"hidden"})))};T.propTypes={form:z().object.isRequired,prefix:z().string};const L=T;var H=n(26069),W=n(70581),G=n(23132),R=n(82926),q=n(90788),$=n(56344),F=n(73448);function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach(function(t){(0,l.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const J=({order:e,productItemsMap:t,currency:n})=>{var a,r;const l=(null===(a=(0,I.getConfig)())||void 0===a||null===(r=a.app)||void 0===r?void 0:r.storeLocatorEnabled)??F.mP,{pickupShipments:m,deliveryShipments:d}=(0,c.useMemo)(()=>l?(0,j.JR)(e):{pickupShipments:[],deliveryShipments:(null==e?void 0:e.shipments)||[]},[null==e?void 0:e.shipments,l]),E=(0,s.YK)({pickupItems:{id:"order_summary.label.pickup_items",defaultMessage:[{type:0,value:"Pickup Items"}]},deliveryItems:{id:"order_summary.label.delivery_items",defaultMessage:[{type:0,value:"Delivery Items"}]}}),f=(a,r)=>0===a.length?null:c.createElement(o.az,{key:r.id},c.createElement(p.E,{fontSize:"sm",fontWeight:"semibold",mb:3},c.createElement(i.A,r)),c.createElement(u.B,{spacing:4},a.map(a=>{const r=(l=a.shipmentId,e.productItems.filter(e=>e.shipmentId===l));var l;return c.createElement(o.az,{key:a.shipmentId},c.createElement(u.B,{spacing:3,align:"flex-start",width:"full",divider:c.createElement(h.c,null)},r.map((e,a)=>{const r=(null==t?void 0:t[e.productId])||{},l=Y(Y(Y({},e),r),{},{price:e.price});return c.createElement(W.A,{key:e.productId,index:a,variant:l},c.createElement(v.s,{width:"full",alignItems:"flex-start"},c.createElement(G.A,{width:"80px",mr:2}),c.createElement(u.B,{spacing:1,marginTop:"-3px",flex:1},c.createElement(R.A,null),c.createElement(v.s,{width:"full",justifyContent:"space-between",alignItems:"flex-end"},c.createElement(q.A,{includeQuantity:!0}),c.createElement($.A,{currency:n})))))})))})));return c.createElement(u.B,{spacing:6,width:"full"},f(m,E.pickupItems),f(d,E.deliveryItems))};J.propTypes={order:z().object.isRequired,productItemsMap:z().object.isRequired,currency:z().string.isRequired};const Q=J;var U=n(20918);const V="undefined"!=typeof window,X=({shipments:e=[]})=>{var t,n;const a=(null===(t=(0,I.getConfig)())||void 0===t||null===(n=t.app)||void 0===n?void 0:n.storeLocatorEnabled)??F.mP,r=(null==e?void 0:e.filter(e=>a&&(0,j.f_)(e)).map(e=>e.c_fromStoreId).filter(Boolean))||[],{data:l}=(0,S.useStores)({parameters:{ids:r.join(",")}},{enabled:r.length>0&&V});if(!e||0===e.length)return null;const s=[],E=[];return e.forEach(e=>{a&&(0,j.f_)(e)?s.push(e):E.push(e)}),c.createElement(u.B,{spacing:4},s.length>0&&c.createElement(o.az,{layerStyle:"card",rounded:[0,0,"base"],px:[4,4,6],py:[6,6,8]},c.createElement(m.m,{variant:"form"},c.createElement(u.B,{spacing:6},c.createElement(d.D,{fontSize:"lg"},c.createElement(i.A,{defaultMessage:[{type:0,value:"Pickup Details"}],id:"checkout_confirmation.heading.pickup_details"})),c.createElement(u.B,{spacing:4},s.map((e,t)=>{const n=(a=e.c_fromStoreId,null!=l&&l.data?l.data.find(e=>e.id===a):null);var a;return c.createElement(o.az,{key:`pickup-${t}`},s.length>1&&c.createElement(d.D,{as:"h3",fontSize:"md",mb:3},c.createElement(i.A,{defaultMessage:[{type:0,value:"Pickup Location "},{type:1,value:"number"}],id:"checkout_confirmation.heading.pickup_location_number",values:{number:t+1}})),c.createElement(u.B,{spacing:2},c.createElement(d.D,{as:"h3",fontSize:"sm"},c.createElement(i.A,{defaultMessage:[{type:0,value:"Pickup Address"}],id:"checkout_confirmation.heading.pickup_address"})),n?c.createElement(U.A,{store:n,showDistance:!0,showEmail:!0,showPhone:!0,showStoreHours:!0}):c.createElement(p.E,null,c.createElement(i.A,{defaultMessage:[{type:0,value:"Store information isn't available"}],id:"checkout_confirmation.message.store_info_unavailable"}))),t<s.length-1&&c.createElement(h.c,{my:4}))}))))),E.length>0&&c.createElement(o.az,{layerStyle:"card",rounded:[0,0,"base"],px:[4,4,6],py:[6,6,8]},c.createElement(m.m,{variant:"form"},c.createElement(u.B,{spacing:6},c.createElement(d.D,{fontSize:"lg"},c.createElement(i.A,{defaultMessage:[{type:0,value:"Delivery Details"}],id:"checkout_confirmation.heading.delivery_details"})),c.createElement(u.B,{spacing:4},E.map((e,t)=>c.createElement(o.az,{key:`delivery-${t}`},E.length>1&&c.createElement(d.D,{as:"h3",fontSize:"md",mb:3},c.createElement(i.A,{defaultMessage:[{type:0,value:"Delivery "},{type:1,value:"number"}],id:"checkout_confirmation.heading.delivery_number",values:{number:t+1}})),c.createElement(b.r,{columns:[1,1,2],spacing:6},c.createElement(u.B,{spacing:1},c.createElement(d.D,{as:"h3",fontSize:"sm"},c.createElement(i.A,{defaultMessage:[{type:0,value:"Shipping Address"}],id:"checkout_confirmation.heading.shipping_address"})),c.createElement(M.A,{address:e.shippingAddress})),c.createElement(u.B,{spacing:1},c.createElement(d.D,{as:"h3",fontSize:"sm"},c.createElement(i.A,{defaultMessage:[{type:0,value:"Shipping Method"}],id:"checkout_confirmation.heading.shipping_method"})),c.createElement(o.az,null,c.createElement(p.E,null,e.shippingMethod.name),c.createElement(p.E,null,e.shippingMethod.description)))),t<E.length-1&&c.createElement(h.c,{my:4}))))))))};X.propTypes={shipments:z().array};const Z=X;var ee=n(7711),te=n(60309),ne=n(79060);const ae=["id","_type"];function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach(function(t){(0,l.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const ce="undefined"!=typeof window,ie=()=>{var e,t,n,l,B,D,z,P,C,N,T,K,Y,J;const{orderNo:U}=(0,_.g)(),V=(0,ee.A)(),{data:X}=(0,te.J)(),re=(0,S.useAuthHelper)(S.AuthHelpers.Register),ie=(0,S.useShopperCustomersMutation)("createCustomerAddress"),{data:se}=(0,S.useOrder)({parameters:{orderNo:U}},{enabled:!!U&&ce}),{currency:oe}=(0,ne.H2)(),me=null==se?void 0:se.productItems.map(e=>e.productId),{data:ue}=(0,S.useProducts)({parameters:{ids:null==me?void 0:me.join(",")}}),de=((null==ue?void 0:ue.data)||[]).reduce((e,t)=>le(le({},e),{},{[t.id]:t}),{}),pe=(0,A.mN)(),Ee=(null==se?void 0:se.shipments)&&se.shipments.length>1;if((0,c.useEffect)(()=>{var e,t,n;pe.reset({email:(null==se||null===(e=se.customerInfo)||void 0===e?void 0:e.email)||"",password:"",firstName:null==se||null===(t=se.billingAddress)||void 0===t?void 0:t.firstName,lastName:null==se||null===(n=se.billingAddress)||void 0===n?void 0:n.lastName})},[se]),!se||!se.orderNo)return null;const fe=(0,w.N0)(null===(e=se.paymentInstruments[0].paymentCard)||void 0===e?void 0:e.cardType),ye=function(){var e=(0,r.A)(function*(e){const t=function(){var e=(0,r.A)(function*(e){try{var t,n;const r=(null===(t=(0,I.getConfig)())||void 0===t||null===(n=t.app)||void 0===n?void 0:n.storeLocatorEnabled)??F.mP,l=(se.shipments||[]).filter(e=>!(!e.shippingAddress||r&&(0,j.f_)(e))),c=[];l.forEach(e=>{const t=e.shippingAddress;c.some(e=>(0,x.t4)(e,t))||c.push(t)});for(let t=0;t<c.length;t++){const n=c[t],{id:r,_type:l}=n,i=(0,a.A)(n,ae),s=le({addressId:(0,k.Ak)()},i);yield ie.mutateAsync({body:s,parameters:{customerId:e}})}}catch(e){}});return function(t){return e.apply(this,arguments)}}();try{const n={customer:{firstName:e.firstName,lastName:e.lastName,email:e.email,login:e.email,phoneHome:se.billingAddress.phone},password:e.password},a=yield re.mutateAsync(n);yield t(a.customerId),V("/account")}catch(e){if(!e.response)return void pe.setError("global",{type:"manual",message:F.gS});const t=yield e.response.json(),n=c.createElement(c.Fragment,null,c.createElement(i.A,{defaultMessage:[{type:0,value:"This email already has an account."}],id:"checkout_confirmation.message.already_has_account"})," ",c.createElement(O.A,{to:"/login",color:"blue.600"},c.createElement(i.A,{defaultMessage:[{type:0,value:"Log in here"}],id:"checkout_confirmation.link.login"}))),a=/the login is already in use/i.test(t.detail)?n:F.gS;pe.setError("global",{type:"manual",message:a})}});return function(t){return e.apply(this,arguments)}}();return c.createElement(o.az,{background:"gray.50"},c.createElement(m.m,{maxWidth:"container.md",py:{base:7,md:16},px:{base:0,md:4},"data-testid":"sf-checkout-confirmation-container"},c.createElement(u.B,{spacing:4},c.createElement(o.az,{layerStyle:"card",rounded:[0,0,"base"],px:[4,4,6],py:[6,6,8]},c.createElement(u.B,{spacing:6},c.createElement(d.D,{as:"h1",align:"center",fontSize:["2xl"]},c.createElement(i.A,{defaultMessage:[{type:0,value:"Thank you for your order!"}],id:"checkout_confirmation.heading.thank_you_for_order"})),c.createElement(o.az,null,c.createElement(m.m,{variant:"form"},c.createElement(u.B,{spacing:3},c.createElement(p.E,{align:"center"},c.createElement(i.A,{defaultMessage:[{type:0,value:"Order Number"}],id:"checkout_confirmation.label.order_number"}),":"," ",c.createElement(p.E,{as:"span",fontWeight:"bold"},se.orderNo)),c.createElement(p.E,{align:"center"},c.createElement(i.A,{defaultMessage:[{type:0,value:"We will send an email to "},{type:8,value:"b",children:[{type:1,value:"email"}]},{type:0,value:" with your confirmation number and receipt shortly."}],id:"checkout_confirmation.message.will_email_shortly",values:{b:e=>c.createElement("b",null,e),email:se.customerInfo.email}})),c.createElement(E.h,null),c.createElement(f.$,{as:O.A,href:"/",variant:"outline"},c.createElement(i.A,{defaultMessage:[{type:0,value:"Continue Shopping"}],id:"checkout_confirmation.link.continue_shopping"}))))))),X.isGuest&&c.createElement(o.az,{layerStyle:"card",rounded:[0,0,"base"],px:[4,4,6],py:[6,6,8]},c.createElement(m.m,{variant:"form"},c.createElement(d.D,{fontSize:"lg",marginBottom:6},c.createElement(i.A,{defaultMessage:[{type:0,value:"Create an account for faster checkout"}],id:"checkout_confirmation.heading.create_account"})),c.createElement("form",{onSubmit:pe.handleSubmit(ye)},c.createElement(u.B,{spacing:4},(null===(t=pe.formState.errors)||void 0===t?void 0:t.global)&&c.createElement(y.F,{status:"error"},c.createElement(g._,null),pe.formState.errors.global.message),c.createElement(L,{form:pe}),c.createElement(f.$,{type:"submit",width:"full",onClick:()=>pe.clearErrors("global"),isLoading:pe.formState.isSubmitting},c.createElement(i.A,{defaultMessage:[{type:0,value:"Create Account"}],id:"checkout_confirmation.button.create_account"})))))),c.createElement(Z,{shipments:se.shipments}),c.createElement(o.az,{layerStyle:"card",rounded:[0,0,"base"],px:[4,4,6],py:[6,6,8]},c.createElement(m.m,{variant:"form"},c.createElement(u.B,{spacing:6},c.createElement(d.D,{fontSize:"lg"},c.createElement(i.A,{defaultMessage:[{type:0,value:"Order Summary"}],id:"checkout_confirmation.heading.order_summary"})),c.createElement(u.B,{spacing:4},c.createElement(p.E,null,c.createElement(i.A,{defaultMessage:[{type:6,value:"itemCount",options:{"=0":{value:[{type:0,value:"0 items"}]},one:{value:[{type:7},{type:0,value:" item"}]},other:{value:[{type:7},{type:0,value:" items"}]}},offset:0,pluralType:"cardinal"}],values:{itemCount:se.productItems.reduce((e,t)=>e+t.quantity,0)},id:"checkout_confirmation.message.num_of_items_in_order"})),c.createElement(u.B,{spacing:5,align:"flex-start"},Ee?c.createElement(Q,{order:se,productItemsMap:de,currency:oe}):c.createElement(u.B,{spacing:5,align:"flex-start",width:"full",divider:c.createElement(h.c,null)},null===(n=se.productItems)||void 0===n?void 0:n.map((e,t)=>{const n=(null==de?void 0:de[e.productId])||{},a=le(le(le({},e),n),{},{price:e.price});return c.createElement(W.A,{key:e.productId,index:t,variant:a},c.createElement(v.s,{width:"full",alignItems:"flex-start"},c.createElement(G.A,{width:"80px",mr:2}),c.createElement(u.B,{spacing:1,marginTop:"-3px",flex:1},c.createElement(R.A,null),c.createElement(v.s,{width:"full",justifyContent:"space-between",alignItems:"flex-end"},c.createElement(q.A,{includeQuantity:!0}),c.createElement($.A,{currency:oe})))))})),c.createElement(u.B,{w:"full",py:4,borderY:"1px",borderColor:"gray.200"},c.createElement(v.s,{justify:"space-between"},c.createElement(p.E,{fontWeight:"bold"},c.createElement(i.A,{defaultMessage:[{type:0,value:"Subtotal"}],id:"checkout_confirmation.label.subtotal"})),c.createElement(p.E,{fontWeight:"bold"},c.createElement(s.Gr,{style:"currency",currency:null==se?void 0:se.currency,value:null==se?void 0:se.productSubTotal}))),null===(l=se.orderPriceAdjustments)||void 0===l?void 0:l.map(e=>c.createElement(v.s,{justify:"space-between",key:e.priceAdjustmentId},c.createElement(p.E,null,e.itemText),c.createElement(p.E,{color:"green.500"},c.createElement(s.Gr,{style:"currency",currency:null==se?void 0:se.currency,value:e.price})))),c.createElement(v.s,{justify:"space-between"},c.createElement(v.s,{alignItems:"center"},c.createElement(p.E,{lineHeight:1},c.createElement(i.A,{defaultMessage:[{type:0,value:"Shipping"}],id:"checkout_confirmation.label.shipping"}),(null===(B=se.shippingItems[0].priceAdjustments)||void 0===B?void 0:B.length)>0&&c.createElement(p.E,{as:"span",ml:1},"(",c.createElement(i.A,{defaultMessage:[{type:0,value:"Promotion applied"}],id:"checkout_confirmation.label.promo_applied"}),")")),(null===(D=se.shippingItems)||void 0===D||null===(z=D[0])||void 0===z||null===(P=z.priceAdjustments)||void 0===P?void 0:P.length)>0&&c.createElement(H.A,{ml:2},c.createElement(u.B,null,null===(C=se.shippingItems[0].priceAdjustments)||void 0===C?void 0:C.map(e=>c.createElement(p.E,{key:e.priceAdjustmentId,fontSize:"sm"},e.itemText))))),null!==(N=se.shippingItems[0].priceAdjustments)&&void 0!==N&&N.some(({appliedDiscount:e})=>"free"===(null==e?void 0:e.type))?c.createElement(p.E,{as:"span",color:"green.500",textTransform:"uppercase"},c.createElement(i.A,{defaultMessage:[{type:0,value:"Free"}],id:"checkout_confirmation.label.free"})):c.createElement(p.E,null,c.createElement(s.Gr,{value:se.shippingTotal,style:"currency",currency:se.currency}))),c.createElement(v.s,{justify:"space-between"},c.createElement(p.E,null,c.createElement(i.A,{defaultMessage:[{type:0,value:"Tax"}],id:"checkout_confirmation.label.tax"})),c.createElement(p.E,null,c.createElement(s.Gr,{value:se.taxTotal,style:"currency",currency:se.currency})))),c.createElement(v.s,{w:"full",justify:"space-between"},c.createElement(p.E,{fontWeight:"bold"},c.createElement(i.A,{defaultMessage:[{type:0,value:"Order Total"}],id:"checkout_confirmation.label.order_total"})),c.createElement(p.E,{fontWeight:"bold"},c.createElement(s.Gr,{style:"currency",currency:null==se?void 0:se.currency,value:null==se?void 0:se.orderTotal})))))))),c.createElement(o.az,{layerStyle:"card",rounded:[0,0,"base"],px:[4,4,6],py:[6,6,8]},c.createElement(m.m,{variant:"form"},c.createElement(u.B,{spacing:6},c.createElement(d.D,{fontSize:"lg"},c.createElement(i.A,{defaultMessage:[{type:0,value:"Payment Details"}],id:"checkout_confirmation.heading.payment_details"})),c.createElement(b.r,{columns:[1,1,2],spacing:6},c.createElement(u.B,{spacing:1},c.createElement(d.D,{as:"h3",fontSize:"sm"},c.createElement(i.A,{defaultMessage:[{type:0,value:"Billing Address"}],id:"checkout_confirmation.heading.billing_address"})),c.createElement(M.A,{address:se.billingAddress})),c.createElement(u.B,{spacing:1},c.createElement(d.D,{as:"h3",fontSize:"sm"},c.createElement(i.A,{defaultMessage:[{type:0,value:"Credit Card"}],id:"checkout_confirmation.heading.credit_card"})),c.createElement(u.B,{direction:"row"},fe&&c.createElement(fe,{layerStyle:"ccIcon"}),c.createElement(o.az,null,c.createElement(p.E,null,null===(T=se.paymentInstruments[0].paymentCard)||void 0===T?void 0:T.cardType),c.createElement(u.B,{direction:"row"},c.createElement(p.E,null,"••••"," ",null===(K=se.paymentInstruments[0].paymentCard)||void 0===K?void 0:K.numberLastDigits),c.createElement(p.E,null,null===(Y=se.paymentInstruments[0].paymentCard)||void 0===Y?void 0:Y.expirationMonth,"/",null===(J=se.paymentInstruments[0].paymentCard)||void 0===J?void 0:J.expirationYear))))))))))))}}}]);