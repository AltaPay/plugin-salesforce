"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[505,852],{535(e,t,r){r.d(t,{A:()=>B});var o=r(18801),a=r(10939),n=r(77810),l=r(75826),i=r.n(l),c=r(16602),s=r(41863),u=r(25687),m=r(99424),d=r(93633),p=r(95266),f=r(16995),y=r(94480),b=r(27821),E=r(92519),v=r(91311),g=r(62539),A=r(59247),h=r(11692),_=r(87916),S=r(69879),j=r(70581),O=r(23132),P=r(82926),I=r(90788),w=r(56344),C=r(26069),x=r(90031),k=r(35490);const z=["removePromoCode"];function M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?M(Object(r),!0).forEach(function(t){(0,a.A)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}const L=({basket:e})=>{var t,r,o;const a=(null==e||null===(t=e.productItems)||void 0===t?void 0:t.reduce((e,t)=>e+t.quantity,0))||0,l=(null==e||null===(r=e.productItems)||void 0===r?void 0:r.map(({productId:e})=>e).join(","))??"",{data:i}=(0,x.useProducts)({parameters:{ids:l,allImages:!0}},{enabled:Boolean(l),select:e=>{var t;return null==e||null===(t=e.data)||void 0===t?void 0:t.reduce((e,t)=>(e[t.id]=t,e),{})}});return n.createElement(y.n,{allowToggle:!0,width:"100%"},n.createElement(d.A,{style:{border:0}},n.createElement(u.J,{color:"blue.700"},n.createElement(k.C$,{"aria-hidden":!0}),n.createElement(g.az,{px:2},n.createElement(s.A,{id:"order_summary.cart_items.action.num_of_items_in_cart",defaultMessage:[{type:6,value:"itemCount",options:{"=0":{value:[{type:0,value:"0 items"}]},one:{value:[{type:7},{type:0,value:" item"}]},other:{value:[{type:7},{type:0,value:" items"}]}},offset:0,pluralType:"cardinal"},{type:0,value:" in cart"}],values:{itemCount:a}})),n.createElement(m.Q,null)),n.createElement(f.v,{px:0,py:4},n.createElement(E.B,{spacing:5,align:"flex-start",divider:n.createElement(A.c,null)},null===(o=e.productItems)||void 0===o?void 0:o.map((t,r)=>{const o=T(T(T({},t),i&&i[t.productId]),{},{price:t.price});return n.createElement(j.A,{key:`order-summary-item-${t.productId}-${t.itemId}`,index:r,variant:o},n.createElement(h.s,{width:"full",alignItems:"flex-start"},n.createElement(O.A,{width:"80px",mr:2}),n.createElement(E.B,{width:"full",spacing:1,marginTop:"-3px"},n.createElement(P.A,null),n.createElement(I.A,{includeQuantity:!0}),n.createElement(w.A,{baseDirection:"row",currency:null==e?void 0:e.currency}))))}),n.createElement(p.$,{as:_.A,to:"/cart",variant:"link",width:"full",color:"blue.700"},n.createElement(s.A,{defaultMessage:[{type:0,value:"Edit cart"}],id:"order_summary.cart_items.link.edit_cart"}))))))};L.propTypes={basket:i().object};const D=({basket:e,showPromoCodeForm:t=!1,showCartItems:r=!1,isEstimate:a=!1,fontSize:l="md"})=>{var i,u,m,d,f;const y=(0,S.mx)(),{removePromoCode:_}=y,j=(0,o.A)(y,z);if(!(null!=e&&e.basketId||null!=e&&e.orderNo))return null;const O=null===(i=e.shippingItems)||void 0===i?void 0:i[0],P=(null==O||null===(u=O.priceAdjustments)||void 0===u?void 0:u.length)>0;return n.createElement(E.B,{"data-testid":"sf-order-summary",spacing:5},n.createElement(v.D,{fontSize:l,pt:1,id:"order-summary-heading"},n.createElement(s.A,{defaultMessage:[{type:0,value:"Order Summary"}],id:"order_summary.heading.order_summary"})),n.createElement(E.B,{spacing:4,align:"flex-start",role:"region","aria-labelledby":"order-summary-heading"},r&&n.createElement(L,{basket:e}),n.createElement(E.B,{w:"full"},n.createElement(h.s,{justify:"space-between","aria-live":"polite","aria-atomic":"true"},n.createElement(b.E,{fontWeight:"bold",fontSize:l},n.createElement(s.A,{defaultMessage:[{type:0,value:"Subtotal"}],id:"order_summary.label.subtotal"})),n.createElement(b.E,{fontWeight:"bold",fontSize:l},n.createElement(c.Gr,{style:"currency",currency:null==e?void 0:e.currency,value:null==e?void 0:e.productSubTotal}))),null===(m=e.orderPriceAdjustments)||void 0===m?void 0:m.map(t=>n.createElement(h.s,{justify:"space-between",key:t.priceAdjustmentId,"aria-live":"polite","aria-atomic":"true"},n.createElement(b.E,{fontSize:l},t.itemText),n.createElement(b.E,{color:"green.600",fontSize:l},n.createElement(c.Gr,{style:"currency",currency:null==e?void 0:e.currency,value:t.price})))),n.createElement(h.s,{justify:"space-between","aria-live":"polite","aria-atomic":"true"},n.createElement(h.s,{alignItems:"center"},n.createElement(b.E,{lineHeight:1,fontSize:l},n.createElement(s.A,{defaultMessage:[{type:0,value:"Shipping"}],id:"order_summary.label.shipping"}),P&&n.createElement(b.E,{as:"span",ml:1},"(",n.createElement(s.A,{defaultMessage:[{type:0,value:"Promotion applied"}],id:"order_summary.label.promo_applied"}),")")),P&&n.createElement(C.A,{ml:1},n.createElement(E.B,null,null==O||null===(d=O.priceAdjustments)||void 0===d?void 0:d.map(e=>n.createElement(b.E,{key:e.priceAdjustmentId,fontSize:"sm"},e.itemText))))),0===e.shippingTotal?n.createElement(b.E,{as:"span",color:"green.700",textTransform:"uppercase",fontSize:l},n.createElement(s.A,{defaultMessage:[{type:0,value:"Free"}],id:"order_summary.label.free"})):n.createElement(b.E,{fontSize:l},n.createElement(c.Gr,{value:e.shippingTotal,style:"currency",currency:e.currency}))),n.createElement(h.s,{justify:"space-between","aria-live":"polite","aria-atomic":"true"},n.createElement(b.E,{fontSize:l},n.createElement(s.A,{defaultMessage:[{type:0,value:"Tax"}],id:"order_summary.label.tax"})),null!=e.taxTotal?n.createElement(b.E,{fontSize:l},n.createElement(c.Gr,{value:e.taxTotal,style:"currency",currency:e.currency})):n.createElement(b.E,{fontSize:l,color:"gray.700"},"TBD"))),t?n.createElement(g.az,{w:"full"},n.createElement(S.rv,j)):n.createElement(A.c,null),n.createElement(E.B,{spacing:4,w:"full"},n.createElement(h.s,{w:"full",justify:"space-between","aria-live":"polite","aria-atomic":"true"},a?n.createElement(b.E,{fontWeight:"bold",fontSize:l},n.createElement(s.A,{defaultMessage:[{type:0,value:"Estimated Total"}],id:"order_summary.label.estimated_total"})):n.createElement(b.E,{fontWeight:"bold",fontSize:l},n.createElement(s.A,{defaultMessage:[{type:0,value:"Order Total"}],id:"order_summary.label.order_total"})),n.createElement(b.E,{fontWeight:"bold",fontSize:l},n.createElement(c.Gr,{style:"currency",currency:null==e?void 0:e.currency,value:(null==e?void 0:e.orderTotal)||(null==e?void 0:e.productTotal)}))),(null===(f=e.couponItems)||void 0===f?void 0:f.length)>0&&n.createElement(E.B,{p:4,border:"1px solid",borderColor:"gray.100",borderRadius:"base",bg:"white"},n.createElement(b.E,{fontWeight:"medium",fontSize:l},n.createElement(s.A,{defaultMessage:[{type:0,value:"Promotions applied"}],id:"order_summary.label.promotions_applied"}),":"),n.createElement(E.B,null,e.couponItems.map(t=>n.createElement(h.s,{key:t.couponItemId,alignItems:"center"},n.createElement(b.E,{flex:"1",fontSize:"sm",color:"gray.800"},t.code),!e.orderNo&&n.createElement(p.$,{variant:"link",size:"sm",colorScheme:"red",onClick:()=>_(t.couponItemId)},n.createElement(s.A,{defaultMessage:[{type:0,value:"Remove"}],id:"order_summary.action.remove_promo"})))))))))};D.propTypes={basket:i().object,showPromoCodeForm:i().bool,showCartItems:i().bool,isEstimate:i().bool,fontSize:i().oneOf(["xs","sm","md","lg","xl"])};const B=D},26647(e,t,r){r.d(t,{A:()=>A});var o=r(64180),a=r(18801),n=r(77810),l=r(17015),i=r(63177),c=r(95266),s=r(92769),u=r(49632),m=r(27821),d=r(41539),p=r(28287),f=r(75826),y=r.n(f),b=r(10575),E=r(34692);const v=["dialogTitle","confirmationMessage","primaryActionLabel","primaryActionAriaLabel","alternateActionLabel","alternateActionAriaLabel","hideAlternateAction","onPrimaryAction","onAlternateAction"],g=e=>{let{dialogTitle:t=b.Gz.dialogTitle,confirmationMessage:r=b.Gz.confirmationMessage,primaryActionLabel:f=b.Gz.primaryActionLabel,primaryActionAriaLabel:y=b.Gz.primaryActionAriaLabel,alternateActionLabel:g=b.Gz.alternateActionLabel,alternateActionAriaLabel:A=b.Gz.alternateActionAriaLabel,hideAlternateAction:h=!1,onPrimaryAction:_=l.lQ,onAlternateAction:S=l.lQ}=e,j=(0,a.A)(e,v);const{formatMessage:O}=(0,E.A)(),P=()=>{S(),j.onClose()};return n.createElement(i.L,(0,o.A)({isOpen:j.isOpen,isCentered:!0,onClose:P},j),n.createElement(d.m,null),n.createElement(i.E,null,n.createElement(u.r,null,O(t)),n.createElement(p.c,null,n.createElement(m.E,null,O(r))),n.createElement(s.j,null,h?null:n.createElement(c.$,{variant:"ghost",mr:3,"aria-label":O(A),onClick:P},O(g)),n.createElement(c.$,{variant:"solid",onClick:()=>{_(),j.onClose()},"aria-label":O(y)},O(f)))))};g.propTypes={isOpen:y().bool.isRequired,onOpen:y().func.isRequired,onClose:y().func.isRequired,dialogTitle:y().object,confirmationMessage:y().object,primaryActionLabel:y().object,primaryActionAriaLabel:y().object,alternateActionLabel:y().object,alternateActionAriaLabel:y().object,onPrimaryAction:y().func,onAlternateAction:y().func,hideAlternateAction:y().bool};const A=g},69879(e,t,r){r.d(t,{rv:()=>w,mx:()=>I});var o=r(28407),a=r(77810),n=r(75826),l=r.n(n),i=r(34692),c=r(41863),s=r(25324),u=r(94480),m=r(93633),d=r(25687),p=r(95266),f=r(16995),y=r(62539),b=r(49785),E=r(35490),v=r(64180),g=r(18801),A=r(63560);const h=["form","prefix"],_=e=>{let{form:t,prefix:r=""}=e,o=(0,g.A)(e,h);const n=function({form:{control:e,formState:{errors:t}},prefix:r=""}){const{formatMessage:o}=(0,i.A)();return{code:{name:`${r}code`,label:o({defaultMessage:[{type:0,value:"Promo Code"}],id:"use_promo_code_fields.label.promo_code"}),type:"text",defaultValue:"",rules:{required:o({defaultMessage:[{type:0,value:"Please provide a valid promo code."}],id:"use_promo_code_fields.error.required_promo_code"})},error:t[`${r}code`],control:e}}}({form:t,prefix:r}),l=t.watch("code");return a.createElement(y.az,(0,v.A)({"aria-labelledby":"code-feedback"},o),a.createElement(A.A,(0,v.A)({inputProps:{flex:1,mr:2}},n.code),a.createElement(p.$,{type:"submit",fontSize:"sm",isLoading:t.formState.isSubmitting,disabled:(null==l?void 0:l.length)<3},a.createElement(c.A,{defaultMessage:[{type:0,value:"Apply"}],id:"promo_code_fields.button.apply"}))))};_.propTypes={form:l().object.isRequired,prefix:l().string};const S=_;var j=r(73448),O=r(90031),P=r(84319);const I=()=>{const{formatMessage:e}=(0,i.A)(),{data:t}=(0,P.X)(),r=(0,b.mN)(),a=(0,s.d)(),n=(0,O.useShopperBasketsMutation)("addCouponToBasket"),l=(0,O.useShopperBasketsMutation)("removeCouponFromBasket"),c=function(){var l=(0,o.A)(function*({code:o}){try{yield n.mutateAsync({parameters:{basketId:null==t?void 0:t.basketId},body:{code:o}}),r.reset({code:""}),a({title:e({defaultMessage:[{type:0,value:"Promotion applied"}],id:"use_promocode.info.promo_applied"}),status:"success",position:"top-right",isClosable:!0})}catch(t){r.setError("code",{type:"manual",message:e({defaultMessage:[{type:0,value:"Check the code and try again, it may already be applied or the promo has expired."}],id:"use_promocode.error.check_the_code"})},{shouldFocus:!0})}});return function(e){return l.apply(this,arguments)}}(),u=function(){var r=(0,o.A)(function*(r){l.mutate({parameters:{basketId:null==t?void 0:t.basketId,couponItemId:r}},{onSuccess:()=>{a({title:e({defaultMessage:[{type:0,value:"Promotion removed"}],id:"use_promocode.info.promo_removed"}),status:"success",position:"top-right",isClosable:!0})},onError:()=>{a({title:e(j.gS),status:"error",position:"top-right",isClosable:!0})}})});return function(e){return r.apply(this,arguments)}}();return{form:r,submitPromoCode:c,removePromoCode:u}},w=({form:e,submitPromoCode:t,itemProps:r})=>{const[o,n]=(0,a.useState)();return(0,a.useEffect)(()=>{e.formState.isSubmitSuccessful&&n(!1)},[e.formState.isSubmitSuccessful]),a.createElement(u.n,{allowToggle:!0,index:o?0:-1,onChange:()=>n(!o)},a.createElement(m.A,r,({isExpanded:r})=>a.createElement(a.Fragment,null,a.createElement(d.J,{as:p.$,justifyContent:"flex-start",variant:"link",fontSize:"sm",color:"blue.700",rightIcon:r?a.createElement(E.Mt,null):a.createElement(E.D3,null),onClick:()=>e.reset()},a.createElement(c.A,{defaultMessage:[{type:0,value:"Do you have a promo code?"}],id:"promocode.accordion.button.have_promocode"})),a.createElement(f.v,{px:0,mb:4},a.createElement(y.az,{"data-testid":"promo-code-form",as:"form",p:4,background:"white",border:"1px solid",borderColor:"gray.100",borderRadius:"base",onSubmit:e.handleSubmit(t)},a.createElement(S,{form:e,maxWidth:"350px"}))))))};w.propTypes={form:l().object.isRequired,submitPromoCode:l().func.isRequired,itemProps:l().object}},71878(e,t,r){r.d(t,{A:()=>E});var o=r(64180),a=r(28407),n=r(10939),l=r(77810),i=r(75826),c=r.n(i),s=r(90031),u=r(73448),m=r(26647),d=r(75002),p=r(17015);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach(function(t){(0,n.A)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}const b=({productIds:e=[],productItems:t=[],handleUnavailableProducts:r=p.lQ})=>{const n=(0,l.useRef)(null),i=e.length?e:t.map(e=>e.productId),c=[...new Set(t.map(e=>e.inventoryId).filter(Boolean))].join(",");(0,s.useProducts)({parameters:y({ids:null==i?void 0:i.join(","),allImages:!0},c?{inventoryIds:c}:{})},{enabled:(null==i?void 0:i.length)>0,onSuccess:e=>{var r;const o=[],a=[];null===(r=e.data)||void 0===r||r.forEach(({id:e,inventory:r,inventories:n})=>{if(o.push(e),t.length){const o=t.find(t=>t.productId===e),l=!(null==o||!o.type),i=(null==n?void 0:n.find(e=>e.id===o.inventoryId))||r;l||null!=i&&i.orderable&&!(null!=i&&i.orderable&&(null==o?void 0:o.quantity)>i.stockLevel)||a.push(e)}});const l=i.filter(e=>!o.includes(e)||a.includes(e));n.current=l}});const f=(0,d.j)();return(0,l.useEffect)(()=>{var e;(null===(e=n.current)||void 0===e?void 0:e.length)>0&&f.onOpen()},[n.current]),l.createElement(m.A,(0,o.A)({"data-testid":"unavailable-product-modal",closeOnEsc:!1,closeOnOverlayClick:!1},u.F1,{hideAlternateAction:!0,onPrimaryAction:(0,a.A)(function*(){yield r(n.current),n.current=null,f.onClose()}),onAlternateAction:()=>{}},f))};b.propTypes={productItems:c().array,productIds:c().array,handleUnavailableProducts:c().func};const E=b}}]);