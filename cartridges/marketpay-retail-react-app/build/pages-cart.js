"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[788],{53853(e,t,n){n.d(t,{A:()=>x});var o=n(64180),r=n(77810),i=n(75826),a=n.n(i),l=n(62539),s=n(92519),d=n(11692),u=n(1308),c=n(27821),m=n(59714),p=n(70581),v=n(23132),y=n(82926),g=n(90788),I=n(56344),f=n(61740),h=n(34692),b=n(41863),E=n(25109);const P=({product:e})=>{const t=(0,h.A)();return r.createElement(E.E,{isLoaded:e},r.createElement(c.E,{fontSize:"sm",color:"gray.700","aria-label":t.formatMessage({id:"item_variant.quantity.label",defaultMessage:[{type:0,value:"Quantity selector for "},{type:1,value:"productName"},{type:0,value:". Selected quantity is "},{type:1,value:"quantity"}]},{quantity:null==e?void 0:e.quantity,productName:null==e?void 0:e.name})},r.createElement(b.A,{defaultMessage:[{type:0,value:"Quantity: "},{type:1,value:"quantity"}],id:"bonus_product_item.label.quantity",values:{quantity:null==e?void 0:e.quantity}})))};P.propTypes={product:a().object};const A=P;var k=n(7963),C=n(88150);const S=({product:e,onItemQuantityChange:t,stepQuantity:n,quantity:o,setQuantity:i})=>{const a=(0,h.A)();return r.createElement(r.Fragment,null,r.createElement(c.E,{fontSize:"sm",color:"gray.700","aria-label":a.formatMessage({id:"item_variant.quantity.label",defaultMessage:[{type:0,value:"Quantity selector for "},{type:1,value:"productName"},{type:0,value:". Selected quantity is "},{type:1,value:"quantity"}]},{quantity:null==e?void 0:e.quantity,productName:null==e?void 0:e.name})},r.createElement(b.A,{defaultMessage:[{type:0,value:"Quantity:"}],id:"product_item.label.quantity"})),r.createElement(C.A,{step:n,value:o,min:0,clampValueOnBlur:!1,onBlur:t=>{const{value:n}=t.target;n||i(e.quantity)},onChange:(e,n)=>{n>=0?t(n).then(e=>e&&i(n)):""===e&&i(e)},productName:null==e?void 0:e.name}),r.createElement(k.s6,{role:"status"},null==e?void 0:e.name,a.formatMessage({id:"item_variant.assistive_msg.quantity",defaultMessage:[{type:0,value:"Quantity "},{type:1,value:"quantity"}]},{quantity:null==e?void 0:e.quantity})))};S.propTypes={product:a().object.isRequired,onItemQuantityChange:a().func.isRequired,stepQuantity:a().number.isRequired,quantity:a().oneOfType([a().number,a().string]).isRequired,setQuantity:a().func.isRequired};const _=S;var O=n(17015),B=n(79060);const w=({product:e,primaryAction:t,secondaryActions:n,deliveryActions:i,onItemQuantityChange:a=O.lQ,showLoading:h=!1,containerStyles:b={},isRemoving:E=!1,pickupInStore:P=!1})=>{const{stepQuantity:k,showInventoryMessage:C,inventoryMessage:S,quantity:w,setQuantity:x}=(0,B.Ki)(e,!1,!1,P),{currency:L}=(0,B.H2)();return r.createElement(l.az,{position:"relative","data-testid":`sf-cart-item-${e.productId?e.productId:e.id}`},r.createElement(p.A,{variant:e},h&&r.createElement(f.A,null),r.createElement(s.B,(0,o.A)({layerStyle:"cardBordered",align:"flex-start"},b),r.createElement(d.s,{width:"full",alignItems:"flex-start",backgroundColor:"white"},r.createElement(v.A,{width:["88px","136px"],mr:4}),r.createElement(s.B,{spacing:3,flex:1},r.createElement(d.s,{align:"flex-end",justify:"space-between"},r.createElement(s.B,{spacing:1},r.createElement(y.A,null),r.createElement(g.A,{excludeBonusLabel:!0}),r.createElement(m.cD,null,r.createElement(l.az,{marginTop:2},r.createElement(I.A,{align:"left",currency:L})))),i&&!e.bonusProductLineItem&&r.createElement(m.qX,null,i)),i&&!e.bonusProductLineItem&&r.createElement(m.cD,null,i),r.createElement(d.s,{align:"flex-end",justify:"space-between"},r.createElement(s.B,{spacing:1},!(E&&e.bonusProductLineItem)&&(e.bonusProductLineItem?r.createElement(A,{product:e}):r.createElement(_,{product:e,onItemQuantityChange:a,stepQuantity:k,quantity:w,setQuantity:x}))),r.createElement(s.B,null,r.createElement(m.qX,null,r.createElement(I.A,{currency:L})),r.createElement(l.az,{display:["none","block","block","block"]},t))),r.createElement(l.az,null,e&&C&&r.createElement(u.z,{in:!0},r.createElement(c.E,{color:"orange.600",fontWeight:600},S))),n)),r.createElement(l.az,{display:["block","none","none","none"],w:"full"},t))))};w.propTypes={product:a().object,onItemQuantityChange:a().func,onAddItemToCart:a().func,showLoading:a().bool,isWishlistItem:a().bool,primaryAction:a().node,secondaryActions:a().node,deliveryActions:a().node,containerStyles:a().object,isRemoving:a().bool,pickupInStore:a().bool};const x=w},63133(e,t,n){n.d(t,{A:()=>f});var o=n(64180),r=n(18801),i=n(77810),a=n(75826),l=n.n(a),s=n(41539),d=n(28287),u=n(21302),c=n(37890),m=n(56548),p=n(63157),v=n(95106),y=n(34692);const g=["product","isOpen","onClose"],I=e=>{var t;let{product:n,isOpen:a,onClose:l}=e,I=(0,r.A)(e,g);const f=(0,v.h)(n),h=(0,y.A)().formatMessage({defaultMessage:[{type:0,value:"Edit modal for "},{type:1,value:"productName"}],id:"cart.product_edit_modal.modal_label"},{productName:null==f||null===(t=f.product)||void 0===t?void 0:t.name});return i.createElement(m.aF,{size:"4xl",isOpen:a,onClose:l},i.createElement(s.m,null),i.createElement(c.$,{containerProps:{"data-testid":"product-view-modal"},"aria-label":h},i.createElement(u.s,null),i.createElement(d.c,{pb:8,bg:"white",paddingBottom:6,marginTop:6},i.createElement(p.A,(0,o.A)({showFullLink:!0,imageSize:"sm",product:f.product,isLoading:f.isFetching},I)))))};I.propTypes={isOpen:l().bool.isRequired,onOpen:l().func.isRequired,onClose:l().func.isRequired,product:l().object,isLoading:l().bool};const f=I},84190(e,t,n){n.r(t),n.d(t,{default:()=>Ve});var o=n(64180),r=n(28407),i=n(10939),a=n(77810),l=n(34692),s=n(41863),d=n(75002),u=n(95266),c=n(62539),m=n(91311),p=n(79237),v=n(92519),y=n(3253),g=n(65602),I=n(75826),f=n.n(I),h=n(27821);const b=({bonusItemsCount:e=0})=>a.createElement(c.az,{layerStyle:"cardBordered",p:3},a.createElement(h.E,{fontWeight:"bold"},a.createElement(s.A,{defaultMessage:[{type:0,value:"Bonus Products ("},{type:6,value:"itemCount",options:{"=0":{value:[{type:0,value:"0 items"}]},one:{value:[{type:7},{type:0,value:" item"}]},other:{value:[{type:7},{type:0,value:" items"}]}},offset:0,pluralType:"cardinal"},{type:0,value:")"}],values:{itemCount:e},id:"bonus_products_title.title.num_of_items"})));b.propTypes={bonusItemsCount:f().number};const E=b;var P=n(11692),A=n(35490),k=n(87916);const C=()=>a.createElement(a.Fragment,null,a.createElement(u.$,{as:k.A,to:"/checkout",width:["95%","95%","95%","100%"],marginTop:[6,6,2,2],mb:4,rightIcon:a.createElement(A.XA,null),variant:"solid"},a.createElement(s.A,{defaultMessage:[{type:0,value:"Proceed to Checkout"}],id:"cart_cta.link.checkout"})),a.createElement(P.s,{justify:"center"},a.createElement(A.nL,{height:8,width:10,mr:2}),a.createElement(A.uI,{height:8,width:10,mr:2}),a.createElement(A.Nx,{height:8,width:10,mr:2}),a.createElement(A.BP,{height:8,width:10,mr:2})));var S=n(59247),_=n(5687),O=n(5631),B=n(16602),w=n(70581),x=n(26647),L=n(17015),q=n(60309);const D={dialogTitle:(0,B.zR)({defaultMessage:[{type:0,value:"Confirm Remove Item"}],id:"confirmation_modal.remove_cart_item.title.confirm_remove"}),confirmationMessage:(0,B.zR)({defaultMessage:[{type:0,value:"Are you sure you want to remove this item from your cart?"}],id:"confirmation_modal.remove_cart_item.message.sure_to_remove"}),primaryActionLabel:(0,B.zR)({defaultMessage:[{type:0,value:"Yes, remove item"}],id:"confirmation_modal.remove_cart_item.action.yes"}),primaryActionAriaLabel:(0,B.zR)({defaultMessage:[{type:0,value:"Yes, remove item"}],id:"confirmation_modal.remove_cart_item.assistive_msg.yes"}),alternateActionLabel:(0,B.zR)({defaultMessage:[{type:0,value:"No, keep item"}],id:"confirmation_modal.remove_cart_item.action.no"}),alternateActionAriaLabel:(0,B.zR)({defaultMessage:[{type:0,value:"No, keep item"}],id:"confirmation_modal.remove_cart_item.assistive_msg.no"}),onPrimaryAction:L.lQ},M=({onAddToWishlistClick:e=L.lQ,onEditClick:t=L.lQ,onRemoveItemClick:n=L.lQ,onIsAGiftChange:i=L.lQ,isAGift:l=!1})=>{var c;const m=(0,w.e)(),p=null==m?void 0:m.bonusProductLineItem,{data:y}=(0,q.J)(),g=(0,d.j)(),I=function(){var e=(0,r.A)(function*(){n(m)});return function(){return e.apply(this,arguments)}}();return a.createElement(a.Fragment,null,a.createElement(v.B,{direction:{base:"column",lg:"row"},alignItems:{base:"flex-start",lg:"center"},justifyContent:{base:"flex-start",lg:"space-between"},divider:a.createElement(S.c,{display:{base:"block",lg:"none"}})},a.createElement(_.e,{spacing:"6"},a.createElement(u.$,{variant:"link",size:"sm",onClick:()=>{g.onOpen()}},a.createElement(s.A,{defaultMessage:[{type:0,value:"Remove"}],id:"cart_secondary_button_group.action.remove"})),y.isRegistered&&a.createElement(u.$,{variant:"link",size:"sm",onClick:()=>e(m)},a.createElement(s.A,{defaultMessage:[{type:0,value:"Add to Wishlist"}],id:"cart_secondary_button_group.action.added_to_wishlist"})),m.id&&!(null!==(c=m.type)&&void 0!==c&&c.item)&&!p&&a.createElement(u.$,{variant:"link",size:"sm",onClick:()=>t(m)},a.createElement(s.A,{defaultMessage:[{type:0,value:"Edit"}],id:"cart_secondary_button_group.action.edit"}))),!p&&a.createElement(P.s,{alignItems:"center"},a.createElement(O.S,{name:`gift-checkbox-${m.itemId}`,spacing:2,isChecked:l,onChange:e=>{const t=e.target.checked;i(m,t)}},a.createElement(s.A,{defaultMessage:[{type:0,value:"This is a gift."}],id:"cart_secondary_button_group.label.this_is_gift"})))),a.createElement(x.A,(0,o.A)({},D,{onPrimaryAction:I},g)))};M.propTypes={onClick:f().func,onEditClick:f().func,onAddToWishlistClick:f().func,onRemoveItemClick:f().func,onIsAGiftChange:f().func,isAGift:f().bool};const z=M;var R=n(25109);const j=()=>a.createElement(v.B,{spacing:4,layerStyle:"card",boxShadow:"none"},a.createElement(P.s,{width:"full",bg:"white",marginBottom:[4,3]},a.createElement(R.E,{width:["88px","136px"],height:["88px","136px"]}),a.createElement(v.B,{marginLeft:[4,6],spacing:2,flex:1},a.createElement(R.E,{width:"80px",height:"20px"}),a.createElement(R.E,{width:{base:"180px",sm:"180px",md:"280px",lg:"280px"},height:3}),a.createElement(R.E,{width:{base:"120px",sm:"120px",md:"140px",lg:"140px"},height:3})))),T=()=>a.createElement(c.az,{background:"gray.50",flex:"1",paddingBottom:{base:20,lg:55}},a.createElement(p.m,{background:"gray.50","data-testid":"sf-cart-skeleton",maxWidth:"container.xl",p:[4,6,6,4],paddingTop:[null,null,null,6]},a.createElement(y.x,{templateColumns:{base:"1fr",lg:"66% 1fr"},gap:{base:10,xl:20}},a.createElement(g.E,null,a.createElement(v.B,{paddingTop:4,spacing:4},a.createElement(h.E,{fontWeight:"bold",fontSize:["xl","xl","xl","2xl"]},a.createElement(s.A,{defaultMessage:[{type:0,value:"Cart"}],id:"cart_skeleton.title.cart"})),a.createElement(j,null),a.createElement(j,null))),a.createElement(g.E,{py:7},a.createElement(v.B,{paddingTop:{base:0,lg:8},spacing:3,px:[6,6,6,0]},a.createElement(m.D,{fontSize:"lg",pt:1},a.createElement(s.A,{defaultMessage:[{type:0,value:"Order Summary"}],id:"cart_skeleton.heading.order_summary"})),a.createElement(v.B,{spacing:3,align:"flex-start"},a.createElement(R.E,{width:{base:"180px",sm:"180px",md:"280px",lg:"280px"},height:4}),a.createElement(R.E,{width:"120px",height:4}),a.createElement(R.E,{width:{base:"180px",sm:"180px",md:"280px",lg:"280px"},height:4}),a.createElement(R.E,{width:"120px",height:4})))))));var Q=n(84319);const W=()=>{const{derivedData:{totalItems:e}}=(0,Q.X)();return a.createElement(m.D,{as:"h1",fontSize:["xl","xl","xl","2xl"]},a.createElement(s.A,{defaultMessage:[{type:0,value:"Cart ("},{type:6,value:"itemCount",options:{"=0":{value:[{type:0,value:"0 items"}]},one:{value:[{type:7},{type:0,value:" item"}]},other:{value:[{type:7},{type:0,value:" items"}]}},offset:0,pluralType:"cardinal"},{type:0,value:")"}],values:{itemCount:e},id:"cart_title.title.cart_num_of_items"}))};var F=n(77638);const N=({isRegistered:e})=>a.createElement(c.az,{"data-testid":"sf-cart-empty",flex:"1",minWidth:"100%",width:"full",background:"gray.50"},a.createElement(F.o,null,a.createElement(v.B,{spacing:6,width:["343px","444px"],marginTop:"20%",marginBottom:"20%"},a.createElement(c.az,{align:"center"},a.createElement(A.C$,{boxSize:[8,10]})),a.createElement(v.B,{spacing:8},a.createElement(v.B,{spacing:2},a.createElement(h.E,{lineHeight:1,align:"center",fontSize:["18px","2xl"],fontWeight:"bold"},a.createElement(s.A,{defaultMessage:[{type:0,value:"Your cart is empty."}],id:"empty_cart.description.empty_cart"})),a.createElement(h.E,{align:"center",fontSize:"md",color:"gray.700"},e?a.createElement(s.A,{defaultMessage:[{type:0,value:"Continue shopping to add items to your cart."}],id:"empty_cart.message.continue_shopping"}):a.createElement(s.A,{defaultMessage:[{type:0,value:"Sign in to retrieve your saved items or continue shopping."}],id:"empty_cart.message.sign_in_or_continue_shopping"}))),a.createElement(v.B,{justify:"center",direction:["column","row"],spacing:4},a.createElement(u.$,{as:k.A,href:"/",width:["343px","220px"],variant:e?"solid":"outline",color:e?"white":"blue.600"},a.createElement(s.A,{defaultMessage:[{type:0,value:"Continue Shopping"}],id:"empty_cart.link.continue_shopping"})),!e&&a.createElement(u.$,{as:k.A,href:"/account",width:["343px","220px"],rightIcon:a.createElement(A.JM,null),variant:"solid"},a.createElement(s.A,{defaultMessage:[{type:0,value:"Sign In"}],id:"empty_cart.link.sign_in"})))))));N.propTypes={isRegistered:f().bool};const G=N;var $=n(535),X=n(20918);const H=({isPickupOrder:e,store:t,itemsInShipment:n,totalItemsInCart:o,onChangeStore:r})=>a.createElement(c.az,null,e?a.createElement(c.az,null,a.createElement(h.E,{fontWeight:"bold",mb:2},a.createElement(s.A,{defaultMessage:[{type:0,value:"Pick Up in Store - "},{type:1,value:"itemsInShipment"},{type:0,value:" out of "},{type:1,value:"totalItemsInCart"},{type:0,value:" items"}],id:"cart.order_type.pickup_in_store",values:{itemsInShipment:n,totalItemsInCart:o}})),a.createElement(c.az,{layerStyle:"cardBordered",p:4,borderRadius:"md"},a.createElement(X.A,{store:t,showDistance:!0,textSize:"sm",nameStyle:{fontSize:"sm",fontWeight:"semibold"},onChangeStore:r}))):a.createElement(h.E,{fontWeight:"bold"},a.createElement(s.A,{defaultMessage:[{type:0,value:"Delivery - "},{type:1,value:"itemsInShipment"},{type:0,value:" out of "},{type:1,value:"totalItemsInCart"},{type:0,value:" items"}],id:"cart.order_type.delivery",values:{itemsInShipment:n,totalItemsInCart:o}})));H.propTypes={isPickupOrder:f().bool.isRequired,store:f().object,itemsInShipment:f().number.isRequired,totalItemsInCart:f().number.isRequired,onChangeStore:f().func};const U=H;var Y=n(10881);const K="delivery",V="pickup",J=({value:e=K,onChange:t,isPickupDisabled:n=!1,isShipDisabled:o=!1})=>{const r=(0,l.A)();return a.createElement(c.az,null,a.createElement(Y.l,{value:e,onChange:e=>{return n=e.target.value,void(t&&t(n));var n},size:"sm","data-testid":"delivery-option-select","aria-label":r.formatMessage({defaultMessage:[{type:0,value:"Choose delivery option"}],id:"pickup_or_delivery.label.choose_delivery_option"})},a.createElement("option",{value:K,disabled:o},r.formatMessage({defaultMessage:[{type:0,value:"Ship to Address"}],id:"pickup_or_delivery.label.ship_to_address"})),a.createElement("option",{value:V,disabled:n},r.formatMessage({defaultMessage:[{type:0,value:"Pick Up in Store"}],id:"pickup_or_delivery.label.pickup_in_store"}))))};J.propTypes={value:f().oneOf([K,V]),onChange:f().func,isPickupDisabled:f().bool,isShipDisabled:f().bool};const Z=J;var ee=n(53853);function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach(function(t){(0,i.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const oe=({productItems:e=[],renderSecondaryActions:t,renderDeliveryActions:n,onItemQuantityChange:o,onRemoveItemClick:r,productsByItemId:i={},isProductsLoading:l=!1,localQuantity:s={},localIsGiftItems:d={},isCartItemLoading:u=!1,selectedItem:c=null,removingItemIds:m=[],hideBorder:p=!1,hideBottomBorder:y=!1,getShipmentInfoForProduct:g=null})=>a.createElement(v.B,{spacing:4},e.map(e=>{const v=e.bonusProductLineItem,I=m.includes(e.itemId),f=g?g(e):null,h=(null==f?void 0:f.isPickupOrder)||!1;return a.createElement(ee.A,{key:e.itemId,isBonusProduct:v,isRemoving:I,pickupInStore:h,containerStyles:ne({borderX:"none",borderTop:"none",boxShadow:"none"},y&&{borderBottom:"none"}),secondaryActions:t?t({productItem:e,isAGift:d[e.itemId]?d[e.itemId]:e.gift}):null,deliveryActions:n?n(e):null,product:ne(ne(ne({},e),i&&i[e.itemId]),{},{isProductUnavailable:l?void 0:!(null!=i&&i[e.itemId]),price:e.price,quantity:s[e.itemId]?s[e.itemId]:e.quantity}),onItemQuantityChange:null==o?void 0:o.bind(void 0,e),showLoading:u&&(null==c?void 0:c.itemId)===e.itemId||I,handleRemoveItem:r,hideBorder:p})}));oe.propTypes={productItems:f().arrayOf(f().object),renderSecondaryActions:f().func,renderDeliveryActions:f().func,onItemQuantityChange:f().func.isRequired,onRemoveItemClick:f().func,productsByItemId:f().object,isProductsLoading:f().bool,localQuantity:f().object,localIsGiftItems:f().object,isCartItemLoading:f().bool,selectedItem:f().object,removingItemIds:f().arrayOf(f().string),hideBorder:f().bool,hideBottomBorder:f().bool,getShipmentInfoForProduct:f().func};const re=oe;var ie=n(63133),ae=n(18801),le=n(77355),se=n(56548),de=n(41539),ue=n(37890),ce=n(21302),me=n(28287),pe=n(50350),ve=n(63157),ye=n(95106),ge=n(90031),Ie=n(29130),fe=n(79060);const he=["product","isOpen","onClose","updateCart","showDeliveryOptions"];function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach(function(t){(0,i.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const Pe=e=>{var t,n,r,i;let{product:s,isOpen:d,onClose:u,updateCart:m,showDeliveryOptions:p}=e,v=(0,ae.A)(e,he);const y=(0,ye.h)(s),{variationParams:g}=(0,fe.Ki)(s,!1,!1,!1),I=(0,a.useRef)({}),[f,h]=(0,a.useState)({}),[b,E]=(0,a.useState)([]),[A,k]=(0,a.useState)(null==y||null===(t=y.product)||void 0===t?void 0:t.quantity),C=(0,le.A)({base:!0,lg:!1});let S=null===(n=y.product)||void 0===n||null===(r=n.bundledProductItems)||void 0===r?void 0:r.map(({productId:e})=>e).join(",");const _=b.map(({variant:e,product:t})=>(null==e?void 0:e.productId)||(null==t?void 0:t.id)).join(",");(null==_?void 0:_.length)>0&&_!==S&&(S=_);const{data:O,isLoading:B}=(0,ge.useProducts)({parameters:{ids:S,allImages:!0}},{enabled:Boolean(S),keepPreviousData:!0}),w=(0,l.A)().formatMessage({defaultMessage:[{type:0,value:"Edit modal for "},{type:1,value:"productName"}],id:"cart.product_edit_modal.modal_label"},{productName:null==y||null===(i=y.product)||void 0===i?void 0:i.name});return a.createElement(se.aF,{size:"4xl",isOpen:d,onClose:u},a.createElement(de.m,null),a.createElement(ue.$,{containerProps:{"data-testid":"product-view-modal"},"aria-label":w},a.createElement(ce.s,null),a.createElement(me.c,{pb:8,bg:"white",paddingBottom:6,marginTop:6},a.createElement(P.s,{direction:["column","column","column","row"]},a.createElement(c.az,{flex:1,mr:[0,0,0,6,6],display:["none","none","none","block"]},s?a.createElement(a.Fragment,null,a.createElement(Ie.A,{size:"sm",imageGroups:s.imageGroups,selectedVariationAttributes:g})):a.createElement(Ie.E,null)),a.createElement(pe.T,{align:"stretch",flex:1},a.createElement(c.az,{marginBottom:6},a.createElement(ve.A,(0,o.A)({showFullLink:!1,showImageGallery:C,showDeliveryOptions:p,product:y.product,isLoading:y.isFetching,updateCart:(e,t)=>m(e,t,b),validateOrderability:()=>Object.values(I.current).every(({validateOrderability:e})=>e()),childProductOrderability:f,setSelectedBundleQuantity:k},v))),O&&O.data.map((e,t)=>{const n=Ee(Ee({},e),y.product.bundledProductItems[t]),o=n.quantity/s.quantity;return a.createElement(ve.A,{key:t,ref:function(e){I.current[n.itemId]={ref:e,validateOrderability:this.validateOrderability}},showImageGallery:!1,showDeliveryOptions:!1,isProductPartOfBundle:!0,showFullLink:!1,product:n,isLoading:B,setChildProductOrderability:h,childOfBundleQuantity:o,selectedBundleParentQuantity:A,onVariantSelected:(e,n,o)=>{E(r=>{const i=r.slice(0);return i[t]={product:e,variant:n,quantity:o},i})}})}))))))};Pe.propTypes={isOpen:f().bool.isRequired,onOpen:f().func.isRequired,onClose:f().func.isRequired,product:f().object,isLoading:f().bool,updateCart:f().func,showDeliveryOptions:f().bool};const Ae=Pe;var ke=n(55878),Ce=n(85959),Se=n(50408),_e=n(37938),Oe=n(9387);const Be=({nonBonusProducts:e,basket:t,productsWithPromotions:n,ruleBasedQualifyingProductsMap:r={},isPromotionDataLoading:i,renderProductItem:l,getPromotionCalloutText:s,onSelectBonusProducts:d,hideBorder:u=!1})=>{var p;return e&&0!==e.length?a.createElement(v.B,{gap:6},e.map((e,p)=>{if(!n||i)return a.createElement(c.az,{key:e.itemId},l(e,p));const y=(0,Oe.Hh)(t,e.productId,n,r);if(!y)return a.createElement(c.az,{key:e.itemId},l(e,p));try{const i=(0,Se.or)(t,e,n,r),g=(0,_e.x8)(t,e.productId,n,{},r),I=i.length>0,f=g.hasRemainingCapacity||y&&0===g.aggregatedMaxBonusItems;return a.createElement(c.az,(0,o.A)({key:e.itemId,"data-testid":`product-group-${e.productId}`,layerStyle:u?"card":"cardBordered",p:4,backgroundColor:"white"},u?{border:"none",borderWidth:"0px",borderRadius:"base"}:{borderWidth:"1px",borderColor:"gray.200",borderRadius:"base"}),a.createElement(c.az,null,l(e,p,{hideBorder:!0})),I&&a.createElement(c.az,{mt:4},a.createElement(m.D,{fontSize:"md",pt:"1",mb:3},"Bonus Products"),a.createElement(v.B,{gap:0},i.map((e,t)=>{const n=t===i.length-1;return a.createElement(c.az,{key:e.itemId,"data-testid":`bonus-product-${e.productId}`,border:"none",borderBottom:"none",borderTop:"none",borderLeft:"none",borderRight:"none"},l(e,t,{showQuantitySelector:!1,hideBorder:!0,hideBottomBorder:n}))}))),I&&f&&a.createElement(c.az,{mt:4,mb:4}),f&&a.createElement(Ce.A,{qualifyingProduct:e,basket:t,productsWithPromotions:n,remainingBonusProductsData:g,isEligible:y,getPromotionCalloutText:s,onSelectBonusProducts:d}))}catch(t){return console.error("Error in enhanced rendering:",t),a.createElement(c.az,{key:e.itemId},l(e,p))}})):a.createElement(v.B,{gap:4},null===(p=t.productItems)||void 0===p?void 0:p.map((e,t)=>l(e,t)))};Be.propTypes={nonBonusProducts:f().arrayOf(f().shape({itemId:f().string,productId:f().string})).isRequired,basket:f().shape({productItems:f().arrayOf(f().shape({itemId:f().string,productId:f().string,bonusProductLineItem:f().bool}))}).isRequired,productsWithPromotions:f().object,ruleBasedQualifyingProductsMap:f().object,isPromotionDataLoading:f().bool.isRequired,renderProductItem:f().func.isRequired,getPromotionCalloutText:f().func.isRequired,onSelectBonusProducts:f().func.isRequired,hideBorder:f().bool};const we=Be;var xe=n(34638),Le=n(7711),qe=n(54851),De=n(19039),Me=n(26660),ze=n(76916),Re=n(88918),je=n(65749),Te=n(73448),Qe=n(4026),We=n(24503),Fe=n.n(We),Ne=n(71878),Ge=n(74941),$e=n(2702),Xe=n(45040),He=n(38446);function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function Ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach(function(t){(0,i.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const Ke=()=>{var e,t,n,i,I,f,h,b,P,A,k,S,_;const{data:O,isLoading:B,derivedData:w}=(0,Q.X)(),L=(null===(e=(0,Qe.getConfig)())||void 0===e||null===(t=e.app)||void 0===t?void 0:t.multishipEnabled)??!0,M=(null===(n=(0,Qe.getConfig)())||void 0===n||null===(i=n.app)||void 0===i?void 0:i.storeLocatorEnabled)??Te.mP,[R,j]=a.useState([]),F=(null===(I=(0,Qe.getConfig)().app)||void 0===I||null===(f=I.pages)||void 0===f||null===(h=f.cart)||void 0===h?void 0:h.groupBonusProductsWithQualifyingProduct)??!0,{selectedStore:N}=(0,Xe.I)(),X=(null==N?void 0:N.inventoryId)||null,H=(null==w||null===(b=w.pickupStoreIds)||void 0===b?void 0:b.join(","))??"",{data:Y}=(0,ge.useStores)({parameters:{ids:H}},{enabled:!!H&&M}),J=[...new Set([X].concat(null==Y||null===(P=Y.data)||void 0===P?void 0:P.map(e=>e.inventoryId)).filter(Boolean))].join(","),{updateDeliveryOption:ee,updateShipmentsWithoutMethods:te,getItemsForShipment:ne,findOrCreatePickupShipment:oe,moveItemsToPickupShipment:ae}=(0,He.n)(O),le=(null==O||null===(A=O.productItems)||void 0===A?void 0:A.map(({productId:e})=>e).join(","))??"",{data:se,ruleBasedQualifyingProductsMap:de,isLoading:ue}=(0,Me.wv)(O),ce=(()=>{const{isOpen:e,data:t,onOpen:n,onClose:o}=(0,ze.u)({closeOnRouteChange:!0,resetDataOnClose:!0});return{isOpen:e,data:t,onOpen:n,onClose:o}})(),{onOpen:me}=(0,Re.ei)(),pe=()=>{const e=(null==O?void 0:O.bonusDiscountLineItems)||[];e.length>0&&me({bonusDiscountLineItems:e})},{data:ve,isLoading:ye}=(0,ge.useProducts)({parameters:Ye({ids:le,allImages:!0,perPricebook:!0},J?{inventoryIds:J}:{})},{enabled:Boolean(le),select:e=>{var t;return null==e||null===(t=e.data)||void 0===t?void 0:t.reduce((e,t)=>(e[t.id]=t,e),{})}}),{data:Ie}=(0,q.J)(),{customerId:fe,isRegistered:he}=Ie,be=[];null==O||null===(k=O.productItems)||void 0===k||k.forEach(e=>{var t;null==e||null===(t=e.bundledProductItems)||void 0===t||t.forEach(e=>{be.push(e.productId)})});const{data:Ee}=(0,ge.useProducts)({parameters:Ye(Ye({ids:null==be?void 0:be.join(","),allImages:!1},J?{inventoryIds:J}:{}),{},{expand:["availability","variations"],select:"(data.(id,inventory,inventories,master))"})},{enabled:(null==be?void 0:be.length)>0,keepPreviousData:!0,select:e=>{var t;return null==e||null===(t=e.data)||void 0===t?void 0:t.reduce((e,t)=>(e[t.id]=t,e),{})}}),Pe=(0,a.useMemo)(()=>{var e;const t=(e,t,n,o=null)=>{var r;const i=!o,a=i?e.inventory:null===(r=e.inventories)||void 0===r?void 0:r.find(e=>e.id===o);let l=(null==a?void 0:a.stockLevel)??Number.MAX_SAFE_INTEGER,s="";return t.bundledProductItems.forEach(e=>{var t;const r=n[e.productId],a=i?null==r?void 0:r.inventory:null==r||null===(t=r.inventories)||void 0===t?void 0:t.find(e=>e.id===o),d=(null==a?void 0:a.stockLevel)??Number.MAX_SAFE_INTEGER;d<l&&(l=d,s=e.productName)}),{lowestStockLevel:l,productWithLowestInventory:s}},n={};return null==O||null===(e=O.productItems)||void 0===e||e.forEach(e=>{let o=null==ve?void 0:ve[null==e?void 0:e.productId];if(o&&null!=e&&e.bundledProductItems&&Ee){if(o.inventory){const{lowestStockLevel:n,productWithLowestInventory:r}=t(o,e,Ee);o=Ye(Ye({},o),{},{inventory:Ye(Ye({},o.inventory),{},{stockLevel:n,lowestStockLevelProductName:r})})}if(o.inventories){const n=o.inventories.map(n=>{const{lowestStockLevel:r,productWithLowestInventory:i}=t(o,e,Ee,n.id);return Ye(Ye({},n),{},{stockLevel:r,lowestStockLevelProductName:i})});o=Ye(Ye({},o),{},{inventories:n})}}n[e.itemId]=o}),n},[O,ve,Ee]),Se=(0,ge.useShopperBasketsMutation)("updateItemInBasket"),_e=(0,ge.useShopperBasketsMutation)("updateItemsInBasket"),Oe=(0,ge.useShopperBasketsMutation)("removeItemFromBasket"),[Be,We]=(0,a.useState)(void 0),[Ue,Ke]=(0,a.useState)({}),[Ve,Je]=(0,a.useState)({}),[Ze,et]=(0,a.useState)(!1),[tt,nt]=(0,a.useState)(!1),{isOpen:ot,onOpen:rt,onClose:it}=(0,d.j)(),{formatMessage:at}=(0,l.A)(),lt=(0,xe.d)(),st=(0,Le.A)(),dt=(0,d.j)(),ut=(0,De.s)(),ct=function(){var e=(0,r.A)(function*(e){var t,n;if(!ye&&null!=N&&N.id&&N.inventoryId&&(null===(t=e.store)||void 0===t?void 0:t.id)!==N.id&&null!==(n=e.shipment)&&void 0!==n&&n.shipmentId)try{var o;et(!0);const t=ne(O,null===(o=e.shipment)||void 0===o?void 0:o.shipmentId),n=t.filter(e=>{var t,n,o;return(null==Pe||null===(t=Pe[e.itemId])||void 0===t||null===(n=t.inventories)||void 0===n||null===(o=n.find(e=>e.id===(null==N?void 0:N.inventoryId)))||void 0===o?void 0:o.stockLevel)>=e.quantity});if(n.length){const e=yield oe(N);yield ae(n,null==e?void 0:e.shipmentId,N.inventoryId)}t.length!==n.length&&lt({title:at(Te.by),status:"error"})}catch(e){console.error("Failed to change store for pickup shipment:",e),mt()}finally{et(!1)}});return function(t){return e.apply(this,arguments)}}();(0,a.useEffect)(()=>{const e=function(){var e=(0,r.A)(function*(){var e;if(!tt&&null!=O&&O.basketId&&(null===(e=O.shipments)||void 0===e?void 0:e.some(e=>!e.shippingMethod))){nt(!0);try{yield te()}catch(e){console.error("Failed to assign default shipping methods:",e)}finally{nt(!1)}}});return function(){return e.apply(this,arguments)}}();e()},[null==O?void 0:O.basketId,null==O||null===(S=O.shipments)||void 0===S?void 0:S.length,tt]);const mt=()=>{lt({title:at(Te.gS),status:"error"})},{data:pt}=(0,qe.T)(),vt=(0,ge.useShopperCustomersMutation)("createCustomerProductListItem"),yt=function(){var e=(0,r.A)(function*(e){try{var t;if(!fe||!pt)return;(null==pt||null===(t=pt.customerProductListItems)||void 0===t?void 0:t.find(t=>t.productId===(null==e?void 0:e.id)))?lt({title:at(Te.p7),status:"info",action:a.createElement(u.$,{variant:"link",onClick:()=>st("/account/wishlist")},at(Te.D$))}):(yield vt.mutateAsync({parameters:{listId:pt.id,customerId:fe},body:{quantity:e.quantity,productId:e.productId,public:!1,priority:1,type:"product"}}),lt({title:at(Te.FD,{quantity:1}),status:"success",action:a.createElement(u.$,{variant:"link",onClick:()=>st("/account/wishlist")},at(Te.D$))}))}catch{mt()}});return function(t){return e.apply(this,arguments)}}(),gt=function(){var e=(0,r.A)(function*(e,t){it();try{et(!0);const n=O.productItems.map(({productId:e})=>e);if(Be.id!==e.productId&&!n.includes(e.productId)){const n={productId:e.productId,quantity:t,price:e.price};return yield Se.mutateAsync({parameters:{basketId:O.basketId,itemId:Be.itemId},body:n})}if(Be.id!==e.productId&&n.includes(e.productId)){yield Oe.mutateAsync({parameters:{basketId:O.basketId,itemId:Be.itemId}});const n=O.productItems.find(({productId:t})=>t===e.productId),o=t+n.quantity;return yield bt(o,n)}if(Be.quantity!==t)return yield bt(t,Be)}catch{mt()}finally{et(!1),We(void 0)}});return function(t,n){return e.apply(this,arguments)}}(),It=function(){var e=(0,r.A)(function*(e,t,n){it();try{et(!0);const o=(0,Ge.NM)(e,n);e.quantity!==t&&o.unshift({itemId:e.itemId,productId:e.productId,quantity:t}),o.length&&(yield _e.mutateAsync({method:"PATCH",parameters:{basketId:O.basketId},body:o}))}catch{mt()}finally{et(!1),We(void 0)}});return function(t,n,o){return e.apply(this,arguments)}}(),ft=function(){var e=(0,r.A)(function*(e,t){try{const n=Ve[e.itemId];Je(Ye(Ye({},Ve),{},{[e.itemId]:t})),et(!0),We(e),yield Se.mutateAsync({parameters:{basketId:null==O?void 0:O.basketId,itemId:e.itemId},body:{productId:e.id,quantity:parseInt(e.quantity),gift:t}},{onSettled:()=>{et(!1),We(void 0)},onSuccess:()=>{Je(Ye(Ye({},Ve),{},{[e.itemId]:void 0}))},onError:()=>{Je(Ye(Ye({},Ve),{},{[e.itemId]:n})),mt()}})}catch(e){mt()}finally{et(!1),We(void 0)}});return function(t,n){return e.apply(this,arguments)}}(),ht=function(){var e=(0,r.A)(function*(e){var t;const n=null==O||null===(t=O.productItems)||void 0===t?void 0:t.filter(t=>null==e?void 0:e.includes(t.productId));yield Promise.all(n.map(function(){var e=(0,r.A)(function*(e){yield Pt(e)});return function(t){return e.apply(this,arguments)}}()))});return function(t){return e.apply(this,arguments)}}(),bt=Fe()(function(){var e=(0,r.A)(function*(e,t){const n=Ue[t.itemId];Ke(Ye(Ye({},Ue),{},{[t.itemId]:e})),et(!0),We(t),yield Se.mutateAsync({parameters:{basketId:null==O?void 0:O.basketId,itemId:t.itemId},body:{productId:t.id,quantity:parseInt(e)}},{onSettled:()=>{et(!1),We(void 0)},onSuccess:()=>{Ke(Ye(Ye({},Ue),{},{[t.itemId]:void 0}))},onError:()=>{Ke(Ye(Ye({},Ue),{},{[t.itemId]:n})),mt()}})});return function(t,n){return e.apply(this,arguments)}}(),750),Et=function(){var e=(0,r.A)(function*(e,t){var n,o,r;const i=(null==Pe||null===(n=Pe[e.itemId])||void 0===n||null===(o=n.inventories)||void 0===o?void 0:o.find(t=>t.id===e.inventoryId))||(null==Pe||null===(r=Pe[e.itemId])||void 0===r?void 0:r.inventory),a=(null==i?void 0:i.stockLevel)??1;return 0===t?(bt.flush(),We(e),dt.onOpen(),!1):(bt.cancel(),t>a||t===e.quantity||bt(t,e),!0)});return function(t,n){return e.apply(this,arguments)}}(),Pt=e=>{if(We(e),et(!0),e.bonusProductLineItem){const t=(0,Me.wd)(O,e);if(t.length>1){const e=t.map(e=>e.itemId);j(e);let n=0,o=0;const r=()=>{if(n>=t.length){if(et(!1),We(void 0),j([]),o>0){const e=t.slice(0,o).reduce((e,t)=>e+(t.quantity||0),0);lt({title:at(Te.Tq,{quantity:e}),status:"success"})}return}const e=t[n];Oe.mutate({parameters:{basketId:O.basketId,itemId:e.itemId}},{onSettled:()=>{n++,setTimeout(r,100)},onSuccess:()=>{o++},onError:e=>{console.error("Item removal error:",e)}})};r()}else Oe.mutate({parameters:{basketId:O.basketId,itemId:e.itemId}},{onSettled:()=>{et(!1),We(void 0)},onSuccess:()=>{lt({title:at(Te.Tq,{quantity:1}),status:"success"})},onError:e=>{console.error("Bonus product removal error:",e),mt()}})}else Oe.mutate({parameters:{basketId:O.basketId,itemId:e.itemId}},{onSettled:()=>{et(!1),We(void 0)},onSuccess:()=>{lt({title:at(Te.Tq,{quantity:1}),status:"success"})},onError:e=>{console.error("Product removal error:",e),mt()}})},At=(0,a.useMemo)(()=>{var e;if(null==O||null===(e=O.shipments)||void 0===e||!e.length)return[];const t=[],n=[];O.shipments.forEach(e=>{var o,r;const i=M&&(0,$e.f_)(e),a=null==e?void 0:e.c_fromStoreId,l=null==Y||null===(o=Y.data)||void 0===o?void 0:o.find(e=>e.id===a),s=((null===(r=O.productItems)||void 0===r?void 0:r.filter(t=>t.shipmentId===e.shipmentId))||[]).reduce((e,t)=>(t.bonusProductLineItem?e.bonusProducts.push(t):e.regularProducts.push(t),e),{regularProducts:[],bonusProducts:[]}),d={shipment:e,isPickupOrder:i,store:l,categorizedProducts:s,itemsInShipment:s.regularProducts.length+s.bonusProducts.length};d.categorizedProducts.regularProducts.length>0&&(i?t.push(d):n.push(d))});const o=[...t];if(n.length>0){const e=n.reduce((e,t)=>(e.regularProducts.push(...t.categorizedProducts.regularProducts),e.bonusProducts.push(...t.categorizedProducts.bonusProducts),e),{regularProducts:[],bonusProducts:[]});o.push({shipment:null,isPickupOrder:!1,store:null,categorizedProducts:e,itemsInShipment:e.regularProducts.length+e.bonusProducts.length})}return o},[null==O?void 0:O.shipments,null==O?void 0:O.productItems,Y]),kt=e=>{var t,n;const o=null==O||null===(t=O.shipments)||void 0===t?void 0:t.find(t=>t.shipmentId===e.shipmentId);if(!o)return null;const r=M&&(0,$e.f_)(o),i=null==o?void 0:o.c_fromStoreId;return{shipment:o,isPickupOrder:r,store:null==Y||null===(n=Y.data)||void 0===n?void 0:n.find(e=>e.id===i)}},Ct=function(){var e=(0,r.A)(function*(e,t){try{var n;et(!0),We(e);const o=t===V;if(o&&!N)return void ut.onOpen();const r=null==ve?void 0:ve[e.productId],i=null==r||null===(n=r.inventory)||void 0===n?void 0:n.id;if(!i)throw new Error(`No inventory ID found for product ${e.productId}`);yield ee(e,o,N,i)}catch(e){console.error("Error changing delivery option:",e),mt()}finally{et(!1),We(void 0)}});return function(t,n){return e.apply(this,arguments)}}(),St=(e,t)=>{var n,o,r,i,l;if(!M||!L)return null;if((0,Me.or)(O,e,se,de).length>0)return null;const s=t.isPickupOrder?V:K,d=(null==Pe||null===(n=Pe[e.itemId])||void 0===n||null===(o=n.inventories)||void 0===o||null===(r=o.find(e=>e.id===X))||void 0===r?void 0:r.stockLevel)>=e.quantity,u=(null==Pe||null===(i=Pe[e.itemId])||void 0===i||null===(l=i.inventory)||void 0===l?void 0:l.stockLevel)>=e.quantity,c=!t.isPickupOrder&&!d,m=t.isPickupOrder&&!u;return a.createElement(Z,{isPickupDisabled:c,isShipDisabled:m,value:s,onChange:t=>Ct(e,t)})},_t=({isAGift:e})=>a.createElement(z,{isAGift:e,onIsAGiftChange:ft,onAddToWishlistClick:yt,onEditClick:e=>{We(e),rt()},onRemoveItemClick:Pt});return B?a.createElement(T,null):B||null!=O&&null!==(_=O.productItems)&&void 0!==_&&_.length?a.createElement(c.az,{background:"gray.50",flex:"1","data-testid":"sf-cart-container"},a.createElement(m.D,{as:"h1",srOnly:!0},a.createElement(s.A,{defaultMessage:[{type:0,value:"Shopping Cart"}],id:"cart.title.shopping_cart"})),a.createElement(p.m,{maxWidth:"container.xl",px:[4,6,6,4],paddingTop:{base:8,lg:8},paddingBottom:{base:8,lg:14}},a.createElement(v.B,{spacing:24},a.createElement(v.B,{spacing:4},a.createElement(W,null),a.createElement(y.x,{templateColumns:{base:"1fr",lg:"66% 1fr"},gap:{base:10,xl:20}},a.createElement(g.E,null,a.createElement(v.B,{spacing:6},At.map(e=>{var t,n,r,i,l,s,d;return a.createElement(c.az,{key:(null===(t=e.shipment)||void 0===t?void 0:t.shipmentId)||"combined-delivery",bg:"white",borderLeft:"1px solid",borderRight:"1px solid",borderBottom:"1px solid",borderColor:"gray.200",borderRadius:"md",borderTopRadius:"none",overflow:"hidden",boxShadow:"sm",p:4},M&&a.createElement(U,{isPickupOrder:e.isPickupOrder,store:e.store,itemsInShipment:e.itemsInShipment,totalItemsInCart:(null==O||null===(n=O.productItems)||void 0===n?void 0:n.length)||0,onChangeStore:N&&N.id!==(null===(r=e.store)||void 0===r?void 0:r.id)?()=>ct(e):null}),F?a.createElement(we,{nonBonusProducts:e.categorizedProducts.regularProducts,basket:O,productsWithPromotions:se,ruleBasedQualifyingProductsMap:de,isPromotionDataLoading:ue,renderProductItem:(e,t,n)=>a.createElement(re,(0,o.A)({key:e.itemId,productItems:[e],productsByItemId:Pe,isProductsLoading:ye,localQuantity:Ue,localIsGiftItems:Ve,isCartItemLoading:Ze,selectedItem:Be,removingItemIds:R,onItemQuantityChange:Et,onRemoveItemClick:Pt,renderSecondaryActions:_t,getShipmentInfoForProduct:kt,renderDeliveryActions:e=>{const t=kt(e);return t?St(e,t):null}},n)),getPromotionCalloutText:Me.zs,onSelectBonusProducts:pe,hideBorder:!0}):a.createElement(v.B,{gap:4},null===(i=e.categorizedProducts.regularProducts)||void 0===i?void 0:i.map(t=>a.createElement(re,{key:t.itemId,productItems:[t],productsByItemId:Pe,isProductsLoading:ye,localQuantity:Ue,localIsGiftItems:Ve,isCartItemLoading:Ze,selectedItem:Be,removingItemIds:R,onItemQuantityChange:Et,onRemoveItemClick:Pt,renderSecondaryActions:_t,getShipmentInfoForProduct:kt,renderDeliveryActions:t=>St(t,e)})),null===(l=e.categorizedProducts.bonusProducts)||void 0===l||null===(s=l.filter(e=>e.bonusDiscountLineItemId))||void 0===s?void 0:s.map(e=>a.createElement(re,{key:e.itemId,productItems:[e],productsByItemId:Pe,isProductsLoading:ye,localQuantity:Ue,localIsGiftItems:Ve,isCartItemLoading:Ze,selectedItem:Be,removingItemIds:R,onItemQuantityChange:Et,onRemoveItemClick:Pt,renderSecondaryActions:_t,getShipmentInfoForProduct:kt,renderDeliveryActions:e=>{const t=kt(e);return t?St(e,t):null}})),null===(d=O.bonusDiscountLineItems)||void 0===d?void 0:d.map(e=>{var t;const n=(null===(t=O.productItems)||void 0===t?void 0:t.find(t=>{var n;return!t.bonusProductLineItem&&(null===(n=t.priceAdjustments)||void 0===n?void 0:n.some(t=>t.promotionId===e.promotionId))}))||{productId:e.promotionId};return a.createElement(Ce.A,{key:e.id,qualifyingProduct:n,basket:O,productsWithPromotions:se,remainingBonusProductsData:{bonusItems:[],hasRemainingCapacity:!0,aggregatedMaxBonusItems:e.maxBonusItems||0,aggregatedSelectedItems:0},bonusDiscountLineItem:e,getPromotionCalloutText:Me.zs,onSelectBonusProducts:pe})}),(t=>{const n=(null===(t=e.categorizedProducts.bonusProducts)||void 0===t?void 0:t.filter(e=>!e.bonusDiscountLineItemId))||[];return n.length>0&&a.createElement(a.Fragment,null,a.createElement(E,{bonusItemsCount:n.length}),a.createElement(re,{productItems:n,productsByItemId:Pe,isProductsLoading:ye,localQuantity:Ue,localIsGiftItems:Ve,isCartItemLoading:Ze,selectedItem:Be,removingItemIds:R,onItemQuantityChange:Et,onRemoveItemClick:Pt,renderSecondaryActions:_t,renderDeliveryActions:e=>{const t=kt(e);return t?St(e,t):null}}))})()),(()=>{const t=e.categorizedProducts.bonusProducts.filter(e=>!e.bonusDiscountLineItemId);return F&&t.length>0&&a.createElement(a.Fragment,null,a.createElement(E,{bonusItemsCount:t.length}),a.createElement(re,{productItems:t,productsByItemId:Pe,isProductsLoading:ye,localQuantity:Ue,localIsGiftItems:Ve,isCartItemLoading:Ze,selectedItem:Be,removingItemIds:R,onItemQuantityChange:Et,onRemoveItemClick:Pt,renderSecondaryActions:_t,renderDeliveryActions:e=>{const t=kt(e);return t?St(e,t):null}}))})())})),a.createElement(c.az,null,ot&&!Be.bundledProductItems&&a.createElement(ie.A,{isOpen:ot,onOpen:rt,onClose:it,product:Be,updateCart:(e,t)=>gt(e,t),showDeliveryOptions:!1}),ot&&Be.bundledProductItems&&a.createElement(Ae,{isOpen:ot,onOpen:rt,onClose:it,product:Be,updateCart:(e,t,n)=>It(e,t,n),showDeliveryOptions:!1}))),a.createElement(g.E,null,a.createElement(v.B,{spacing:4},a.createElement($.A,{showPromoCodeForm:!0,isEstimate:!0,basket:O}),a.createElement(c.az,{display:{base:"none",lg:"block"}},a.createElement(C,null))))),a.createElement(v.B,{spacing:16},a.createElement(ke.A,{title:a.createElement(s.A,{defaultMessage:[{type:0,value:"Recently Viewed"}],id:"cart.recommended_products.title.recently_viewed"}),recommender:Te.tD.CART_RECENTLY_VIEWED,mx:{base:-4,sm:-6,lg:0}}),a.createElement(ke.A,{title:a.createElement(s.A,{defaultMessage:[{type:0,value:"You May Also Like"}],id:"cart.recommended_products.title.may_also_like"}),recommender:Te.tD.CART_MAY_ALSO_LIKE,products:null==O?void 0:O.productItems,shouldFetch:()=>{var e;return(null==O?void 0:O.basketId)&&(null===(e=O.productItems)||void 0===e?void 0:e.length)>0},mx:{base:-4,sm:-6,lg:0}}))))),a.createElement(c.az,{h:"130px",position:"sticky",bottom:0,bg:"white",display:{base:"block",lg:"none"},align:"center"},a.createElement(C,null)),a.createElement(x.A,(0,o.A)({},D,{onPrimaryAction:()=>{Pt(Be)},onAlternateAction:()=>{}},dt)),a.createElement(Ne.A,{productItems:null==O?void 0:O.productItems,handleUnavailableProducts:ht}),ce.isOpen&&ce.data&&a.createElement(je.A,{product:ce.data.product,isOpen:ce.isOpen,onClose:ce.onClose,bonusDiscountLineItemId:ce.data.bonusDiscountLineItemId,promotionId:ce.data.promotionId})):a.createElement(G,{isRegistered:he})};Ke.getTemplateName=()=>"cart";const Ve=Ke}}]);